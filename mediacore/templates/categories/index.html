<!--! This file is a part of MediaCore, Copyright 2009 Simple Station Inc.

	MediaCore is free software: you can redistribute it and/or modify
	it under the terms of the GNU General Public License as published by
	the Free Software Foundation, either version 3 of the License, or
	(at your option) any later version.

	MediaCore is distributed in the hope that it will be useful,
	but WITHOUT ANY WARRANTY; without even the implied warranty of
	MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
	GNU General Public License for more details.

	You should have received a copy of the GNU General Public License
	along with this program.  If not, see <http://www.gnu.org/licenses/>.
-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:py="http://genshi.edgewall.org/"
      xmlns:xi="http://www.w3.org/2001/XInclude">
<xi:include href="../master.html" />
<head>
	<title>Categories</title>
	<link href="${h.url_for('/styles/media.css')}" media="screen" rel="stylesheet" type="text/css" />
	<link href="${h.url_for('/styles/categories.css')}" media="screen" rel="stylesheet" type="text/css" />
</head>
<body class="nav-categories-on">
	<div class="mediacore-content">
		<h2 class="head-super" py:choose="">
			<py:when test="category">
				<span class="uppercase">Categories</span>
				<py:for each="cat in breadcrumb">
					&gt; ${cat.name}
				</py:for>
			</py:when>
			<py:otherwise><span class="uppercase">Choose a Category:</span></py:otherwise>
		</h2>

		<div id="categories-bar">
			<ul py:def="catlist(cats, crumb, depth=0)" class="${depth >= 1 and 'sub' or ''}category-list">
				<li py:for="cat in cats">
					<a class="underline-hover" href="${h.url_for(slug=cat.slug)}">${cat.name}</a>
					<ul py:if="crumb and crumb[0] == cat" py:replace="catlist(cat.children, crumb[1:], depth + 1)" />
				</li>
			</ul>
			${catlist(categories, breadcrumb)}
		</div>

		<div id="category-content" py:if="media" py:with="in_text = category and ('in ' + category.name) or ''">
			<py:if test="c.paginators.media.page == 1">
				<h2><span class="uppercase">Featured</span> ${in_text}</h2>
				<div id="featured-ep" class="feat-ep" py:with="featured = media[0]">
					<div class="feat-top" />
					<div class="feat-content">
						<div class="feat-info">
							<h3><a class="underline-hover" href="${h.url_for(controller='/media', action='view', slug=featured.slug)}">${Markup(featured.title)}</a></h3>
							<p py:replace="Markup(h.truncate_xhtml(featured.description, 300))" />
						</div>
						<div class="feat-meta">
							<span class="meta-comments" title="Comments">${featured.comment_count_published} <span>Comment<py:if test="featured.comment_count_published != 1">s</py:if></span></span>
							<span class="meta-likes" title="Likes">${featured.likes} <span>Like<py:if test="featured.likes != 1">s</py:if></span></span>
							<span class="meta-views" title="Views">${featured.views} <span>View<py:if test="featured.views != 1">s</py:if></span></span>
						</div>
						${media_player(featured, width=400, height=225)}
					</div>
					<div class="feat-bottom" />
				</div>
			</py:if>

			<h2><span class="uppercase">Latest</span> ${in_text}</h2>
			<ul id="category-grid" class="grid2" py:with="media = c.paginators.media.page == 1 and media[1:] or media">
				<li py:for="m in media">
					<a href="${h.url_for(controller='/media', action='view', slug=m.slug)}" class="grid2-link underline-hover">
						<span class="grid2-thumb-wrap">
							<img src="${h.thumb_url(m, 'ss')}" width="128" height="72" alt="${h.decode_entities(m.title)}" class="grid-thumb" />
							<py:if test="m.duration">
								<span class="grid-duration" py:content="h.duration_from_seconds(m.duration)">Duration</span>
								<span class="grid-duration-right" />
							</py:if>
						</span>
						<span class="grid-title">${Markup(m.title)}</span>
					</a>
					<div class="grid-desc" py:content="h.truncate(m.description_plain, 90)">Description here</div>
					<div class="grid-meta">
						<span class="meta-comments" title="Comments">${m.comment_count_published} <span>Comment<py:if test="m.comment_count_published != 1">s</py:if></span></span>
						<span class="meta-likes" title="Likes">${m.likes} <span>Like<py:if test="m.likes != 1">s</py:if></span></span>
						<span class="meta-views" title="Views">${m.views} <span>View<py:if test="m.views != 1">s</py:if></span></span>
					</div>
				</li>
			</ul>
			<div py:content="pagination(c.paginators.media)" />
		</div>
		<div id="category-content" py:if="not media">There is no media in this category.</div>
	</div>
</body>
</html>
